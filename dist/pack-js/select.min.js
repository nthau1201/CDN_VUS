(l=>{let e={classes:"",dropdownOptions:{}};class i extends Component{constructor(e,t){super(i,e,t),this.$el.hasClass("browser-default")||((this.el.M_FormSelect=this).options=l.extend({},i.defaults,t),this.isMultiple=this.$el.prop("multiple"),this.el.tabIndex=-1,this._keysSelected={},this._valueDict={},this._setupDropdown(),this._setupEventHandlers())}static get defaults(){return e}static init(e,t){return super.init(this,e,t)}static getInstance(e){return(e.jquery?e[0]:e).M_FormSelect}destroy(){this._removeEventHandlers(),this._removeDropdown(),this.el.M_FormSelect=void 0}_setupEventHandlers(){this._handleSelectChangeBound=this._handleSelectChange.bind(this),this._handleOptionClickBound=this._handleOptionClick.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),l(this.dropdownOptions).find("li:not(.optgroup)").each(e=>{e.addEventListener("click",this._handleOptionClickBound)}),this.el.addEventListener("change",this._handleSelectChangeBound),this.input.addEventListener("click",this._handleInputClickBound)}_removeEventHandlers(){l(this.dropdownOptions).find("li:not(.optgroup)").each(e=>{e.removeEventListener("click",this._handleOptionClickBound)}),this.el.removeEventListener("change",this._handleSelectChangeBound),this.input.removeEventListener("click",this._handleInputClickBound)}_handleSelectChange(e){this._setValueToInput()}_handleOptionClick(e){e.preventDefault();var t=l(e.target).closest("li")[0];this._selectOption(t),e.stopPropagation()}_selectOption(t){var i=t.id;if(!l(t).hasClass("disabled")&&!l(t).hasClass("optgroup")&&i.length){let e=!0;this.isMultiple?((s=l(this.dropdownOptions).find("li.disabled.selected")).length&&(s.removeClass("selected"),s.find('input[type="checkbox"]').prop("checked",!1),this._toggleEntryFromArray(s[0].id)),e=this._toggleEntryFromArray(i)):(l(this.dropdownOptions).find("li").removeClass("selected"),l(t).toggleClass("selected",e),this._keysSelected={},this._keysSelected[t.id]=!0);var s=l(this._valueDict[i].el).prop("selected");s!==e&&(l(this._valueDict[i].el).prop("selected",e),this.$el.trigger("change"))}this.isMultiple||this.dropdown.close()}_handleInputClick(){this.dropdown&&this.dropdown.isOpen&&(this._setValueToInput(),this._setSelectedStates())}_setupDropdown(){this.wrapper=document.createElement("div"),l(this.wrapper).addClass("select-wrapper "+this.options.classes),this.$el.before(l(this.wrapper));var e=l('<div class="hide-select"></div>'),e=(l(this.wrapper).append(e),e[0].appendChild(this.el),this.el.disabled&&this.wrapper.classList.add("disabled"),this.$selectOptions=this.$el.children("option, optgroup"),this.dropdownOptions=document.createElement("ul"),this.dropdownOptions.id="select-options-"+M.guid(),l(this.dropdownOptions).addClass("dropdown-content select-dropdown "+(this.isMultiple?"multiple-select-dropdown":"")),this.$selectOptions.length&&this.$selectOptions.each(t=>{if(l(t).is("option")){let e;e=this.isMultiple?this._appendOptionWithIcon(this.$el,t,"multiple"):this._appendOptionWithIcon(this.$el,t),this._addOptionToValueDict(t,e)}else{var e;l(t).is("optgroup")&&(e=l(t).children("option"),l(this.dropdownOptions).append(l('<li class="optgroup"><span>'+t.getAttribute("label")+"</span></li>")[0]),e.each(e=>{var t=this._appendOptionWithIcon(this.$el,e,"optgroup-option");this._addOptionToValueDict(e,t)}))}}),l(this.wrapper).append(this.dropdownOptions),this.input=document.createElement("input"),l(this.input).addClass("select-dropdown dropdown-trigger"),this.input.setAttribute("type","text"),this.input.setAttribute("aria-label","User input here"),this.input.setAttribute("readonly","true"),this.input.setAttribute("data-target",this.dropdownOptions.id),this.el.disabled&&l(this.input).prop("disabled","true"),l(this.wrapper).prepend(this.input),this._setValueToInput(),l('<svg class="caret" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'));if(l(this.wrapper).prepend(e[0]),!this.el.disabled){e=l.extend({},this.options.dropdownOptions);let i=e.onOpenEnd;e.onOpenEnd=e=>{var t=l(this.dropdownOptions).find(".selected").first();t.length&&(M.keyDown=!0,this.dropdown.focusedIndex=t.index(),this.dropdown._focusFocusedItem(),M.keyDown=!1,this.dropdown.isScrollable)&&(t=t[0].getBoundingClientRect().top-this.dropdownOptions.getBoundingClientRect().top,t-=this.dropdownOptions.clientHeight/2,this.dropdownOptions.scrollTop=t),i&&"function"==typeof i&&i.call(this.dropdown,this.el)},e.closeOnClick=!1,this.dropdown=M.Dropdown.init(this.input,e)}this._setSelectedStates()}_addOptionToValueDict(e,t){var i=Object.keys(this._valueDict).length,i=this.dropdownOptions.id+i,s={};t.id=i,s.el=e,s.optionEl=t,this._valueDict[i]=s}_removeDropdown(){l(this.wrapper).find(".caret").remove(),l(this.input).remove(),l(this.dropdownOptions).remove(),l(this.wrapper).before(this.$el),l(this.wrapper).remove()}_appendOptionWithIcon(e,t,i){var s=t.disabled?"disabled ":"",i="optgroup-option"===i?"optgroup-option ":"",n=this.isMultiple?`<label><input type="checkbox"${s}"/><span>${t.innerHTML}</span></label>`:t.innerHTML,o=l("<li></li>"),p=l("<span></span>"),n=(p.html(n),o.addClass(s+" "+i),o.append(p),t.getAttribute("data-icon"));return n&&(s=l(`<img alt="" src="${n}">`),o.prepend(s)),l(this.dropdownOptions).append(o[0]),o[0]}_toggleEntryFromArray(e){var t=!this._keysSelected.hasOwnProperty(e),i=l(this._valueDict[e].optionEl);return t?this._keysSelected[e]=!0:delete this._keysSelected[e],i.toggleClass("selected",t),i.find('input[type="checkbox"]').prop("checked",t),i.prop("selected",t),t}_setValueToInput(){let t=[];var e;this.$el.find("option").each(e=>{l(e).prop("selected")&&(e=l(e).text(),t.push(e))}),t.length||(e=this.$el.find("option:disabled").eq(0)).length&&""===e[0].value&&t.push(e.text()),this.input.value=t.join(", ")}_setSelectedStates(){for(var e in this._keysSelected={},this._valueDict){var t=this._valueDict[e],i=l(t.el).prop("selected");l(t.optionEl).find('input[type="checkbox"]').prop("checked",i),i?(this._activateOption(l(this.dropdownOptions),l(t.optionEl)),this._keysSelected[e]=!0):l(t.optionEl).removeClass("selected")}}_activateOption(e,t){t&&(this.isMultiple||e.find("li.selected").removeClass("selected"),l(t).addClass("selected"))}getSelectedValues(){var e,t=[];for(e in this._keysSelected)t.push(this._valueDict[e].el.value);return t}}M.FormSelect=i,M.jQueryLoaded&&M.initializeJqueryWrapper(i,"formSelect","M_FormSelect")})(cash);